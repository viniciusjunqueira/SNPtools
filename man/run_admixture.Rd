% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/admixture.R
\name{run_admixture}
\alias{run_admixture}
\title{Run ADMIXTURE analysis}
\usage{
run_admixture(
  path,
  prefix,
  admixture_path = "admixture",
  K,
  supervised = FALSE,
  pop_assignments = NULL,
  extra_args = NULL,
  out_prefix = NULL,
  cv = NULL
)
}
\arguments{
\item{path}{Character. Path to the folder containing PLINK files.}

\item{prefix}{Character. File prefix (without extension). The function will look for `<prefix>.bed`, `<prefix>.bim`, and `<prefix>.fam` in `path`.}

\item{admixture_path}{Character. Path to the ADMIXTURE executable, or "admixture" if in system PATH. Default is "admixture".}

\item{K}{Integer. Number of ancestral populations to estimate.}

\item{supervised}{Logical. If TRUE, runs ADMIXTURE in supervised mode (requires \code{pop_assignments}). Default is FALSE.}

\item{pop_assignments}{Character vector. Population assignments for each individual (length equal to number of individuals in `.fam`). Use \code{NA} or "-" for missing. Required if \code{supervised = TRUE}.}

\item{extra_args}{Character vector. Additional arguments to pass to ADMIXTURE (e.g., other flags). Default is NULL.}

\item{out_prefix}{Character. Optional prefix for renaming output files (.Q, .P, .log) after the run completes. Default is NULL.}

\item{cv}{Integer. Number of folds for cross-validation (e.g., 5 or 10). If provided, adds \code{--cv=cv}. Default is NULL.}
}
\value{
No value returned. Runs ADMIXTURE as a side effect. Generates output files in the specified directory. Messages indicate progress and output file names.
}
\description{
This function runs the ADMIXTURE program on a set of PLINK files (.bed/.bim/.fam)
located in a specified directory, using a given file prefix. It supports both unsupervised
and supervised analyses, optional cross-validation, and custom output file prefixes to avoid overwriting results.
}
\details{
When \code{supervised = TRUE}, a `.pop` file is automatically created in the specified directory.
Each line in this file corresponds to one individual, containing the population name or "-" for missing assignments.

If \code{out_prefix} is provided, the function renames the standard ADMIXTURE output files 
(e.g., `<prefix>.3.Q`) to use this prefix (e.g., `myrun.Q`).

The function only works on Linux or macOS systems.
}
\examples{
\dontrun{
# Basic unsupervised run
run_admixture(
  path = "~/projects/brangus/admixture_full_pop/",
  prefix = "plink_data",
  admixture_path = "/usr/local/bin/admixture",
  K = 3,
  out_prefix = "run1_k3"
)

# Supervised run with population assignments and cross-validation
pop_vec <- c("Brangus", "Brangus", "Angus", "Angus", "-", "-", "Brangus", "Angus", "Brangus", "-")
run_admixture(
  path = "~/projects/brangus/admixture_full_pop/",
  prefix = "plink_data",
  admixture_path = "/usr/local/bin/admixture",
  K = 3,
  supervised = TRUE,
  pop_assignments = pop_vec,
  cv = 10,
  out_prefix = "supervised_k3_cv10"
)
}

}
