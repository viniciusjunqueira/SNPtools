% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mat2SnpMatrix.R
\name{as_snpmatrix}
\alias{as_snpmatrix}
\title{Convert a genotype matrix or data.frame to snpStats::SnpMatrix}
\usage{
as_snpmatrix(
  geno,
  coding = c("012", "AAABBB"),
  missing_codes = c("NA", "-9", ".", ""),
  check_ids = TRUE
)
}
\arguments{
\item{geno}{A samples x SNPs matrix or data.frame with genotypes coded as
0, 1, 2, or NA. Can be numeric/integer or character. \code{rownames} =
sample IDs, \code{colnames} = SNP IDs.}

\item{coding}{One of \code{"012"} or \code{"AAABBB"}. For character inputs only.
\code{"012"} expects \code{"0"}, \code{"1"}, \code{"2"}, and \code{missing_codes}.
\code{"AAABBB"} expects \code{"AA"}, \code{"AB"}, \code{"BB"}, and \code{missing_codes}.}

\item{missing_codes}{Character values to treat as missing (only used when
\code{geno} is character), e.g., \code{c("NA","-9",".")}.}

\item{check_ids}{If \code{TRUE}, verifies that row and column names are unique
(recommended).}
}
\value{
A \code{snpStats::SnpMatrix} with the same \code{dimnames} as \code{geno}.
}
\description{
This function converts a genotype matrix coded as 0/1/2/NA or AA/AB/BB to a
\code{snpStats::SnpMatrix} object. It includes checks for coding validity,
missing values, and duplicate sample or SNP IDs, and preserves row and column
names from the input.
}
\details{
The function accepts both \code{matrix} and \code{data.frame} inputs. For
\code{data.frame} objects, all columns are coerced to a common type using
\code{as.matrix()}, which preserves \code{rownames} and \code{colnames}.

The returned \code{SnpMatrix} object stores each genotype as a single byte,
which is memory-efficient compared to integer storage. However, large datasets
still require substantial RAM. For very large genotype sets, consider using
on-disk formats such as \pkg{SNPRelate} (GDS) or \pkg{bigsnpr}.
}
\examples{
# Numeric 0/1/2 with NAs
set.seed(1)
geno <- matrix(sample(c(0L,1L,2L,NA), 20, replace=TRUE), nrow=5)
rownames(geno) <- paste0("ind", 1:5)
colnames(geno) <- paste0("snp", 1:4)
SM <- as_snpmatrix(geno)

# Character AA/AB/BB
geno_c <- matrix(sample(c("AA","AB","BB","."), 20, replace=TRUE,
                        prob=c(.35,.3,.3,.05)), nrow=5)
rownames(geno_c) <- rownames(geno)
colnames(geno_c) <- colnames(geno)
SMc <- as_snpmatrix(geno_c, coding="AAABBB", missing_codes=".")

}
